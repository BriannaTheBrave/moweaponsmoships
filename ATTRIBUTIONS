Primary code work by Brian Deale: https://github.com/KelvallRogers
